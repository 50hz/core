<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: behaviors/old/fin-hypergrid-behavior-gol.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: behaviors/old/fin-hypergrid-behavior-gol.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
/**
 *
 * @module behaviors\gol
 *
 */
(function() {

    var noop = function() {};

    var patterns = [
        [
            [false, true, true, true, false],
            [true, false, true, false, true],
            [false, false, true, false, false]
        ],
        [
            [false, true, false],
            [true, false, false],
            [true, true, true]
        ]
    ];
    var colors = ['#ffffff', '#ffffff', '#efefef', '#00e7e7', '#00dfdf', '#00d7d7', '#00cfcf', '#00c7c7'];

    Polymer({ /* jslint ignore:line */

        /**
         * @property {number} rows - the number of rows
         * @instance
         */
        rows: 45,

        /**
         * @property {number} columns - the number of columns
         * @instance
         */
        columns: 75,

        /**
         * @property {Array} data - the matrix of data
         * @instance
         */
        data: [],

        /**
         * @property {Array} buffer - double buffer the data
         * @instance
         */
        buffer: [],

        /**
         * @property {boolean} running - flag if were running or not
         * @instance
         */
        running: false,

        /**
        * @function
        * @instance
        * @description
        polymer lifecycle event
        */
        ready: function() {
            this.readyInit();
            this.rows = this.getAttribute('rows') || this.rows;
            this.columns = this.getAttribute('columns') || this.columns;
            this.resetPetriDish();
            this.running = false;
        },

        /**
         * @function
         * @instance
         * @description
         you can override this function and substitute your own cell provider
         * #### returns: [fin-hypergrid-cell-provider](module-._cell-provider.html)
         */
        createCellProvider: function() {
            var provider = document.createElement('fin-hypergrid-cell-provider');
            provider.cellCache.simpleCellRenderer.paint = function(gc, x, y, width, height) {
                var weight = this.config.value[1];
                if (weight === 0) {
                    return;
                }
                var color = colors[weight];
                if (this.config.value[0]) {
                    color = this.config.fgColor;
                }

                gc.fillStyle = color;
                gc.fillRect(x, y, width, height);
            };
            return provider;
        },

        /**
        * @function
        * @instance
        * @description
        reset the gamegrid
        */
        resetPetriDish: function() {
            this.data = [];
            this.buffer = [];
            this.initializeData(this.data);
            this.initializeData(this.buffer);
            this.populate();
            this.changed();
        },

        /**
        * @function
        * @instance
        * @description
        fill the gamegrid with random valued well known gol templates
        */
        populate: function() {
            var x = 0;
            var y = 0;
            for (var i = 0; i &lt; 15; i++) {
                y = Math.round(Math.random() * this.rows * 0.60);
                x = Math.round(Math.random() * this.columns * 0.60);
                this.applyPatternAt(this.data, x, y, patterns[i % 2], i % 4);
            }
        },

        /**
        * @function
        * @instance
        * @description
        initialize a gamegrid with empty data
        * @param {Array} array2D - a 2d matrix gamegrid
        */
        initializeData: function(array2D) {
            for (var c = 0; c &lt; this.columns; c++) {
                var col = [];
                array2D.push(col);
                for (var r = 0; r &lt; this.rows; r++) {
                    col.push([false, 0]);
                }
            }
        },

        /**
        * @function
        * @instance
        * @description
        turn gol on/off
        */
        toggleRunning: function() {
            this.running = !this.running;
            if (this.running) {
                this.startLife();
            }
        },

        /**
        * @function
        * @instance
        * @description
        start gol
        */
        startLife: function() {
            if (!this.running) {
                return;
            }
            for (var c = 1; c &lt; this.columns - 2; c++) {
                for (var r = 1; r &lt; this.rows - 2; r++) {
                    this.computeLifeAt(c, r);
                }
            }
            var temp = this.buffer;
            this.buffer = this.data;
            this.data = temp;
            this.changed();
            setTimeout(this.startLife.bind(this), 125);
        },

        /**
        * @function
        * @instance
        * @description
        apply the gol rules at a specific point
        */
        computeLifeAt: function(x, y) {
            var me = this._getValue(x, y);
            var total = this.getNeighborCount(x, y);
            me[1] = total;
            if (me[0]) {
                // Any live cell with fewer than two live neighbours dies, as if caused by under-population.
                // Any live cell with two or three live neighbours lives on to the next generation.
                // Any live cell with more than three live neighbours dies, as if by overcrowding.
                if (total &lt; 2) {
                    this.buffer[x][y] = [false, 0];
                } else if (total &lt; 4) {
                    this.buffer[x][y] = [true, 1];
                } else {
                    this.buffer[x][y] = [false, 0];
                }
            } else {
                // Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction.
                this.buffer[x][y] = [(total === 3), total];
            }

        },

        /**
        * @function
        * @instance
        * @description
        return the total weight around point x,y
        * #### returns: float
        * @param {number} x - x coordinate
        * @param {number} y - y coordinate
        */
        getNeighborCount: function(x, y) {
            var data = this.data;
            var total = 0;
            if (data[x - 1][y - 1][0]) {
                total++;
            }
            if (data[x - 1][y][0]) {
                total++;
            }
            if (data[x - 1][y + 1][0]) {
                total++;
            }

            if (data[x][y - 1][0]) {
                total++;
            }
            if (data[x][y + 1][0]) {
                total++;
            }

            if (data[x + 1][y - 1][0]) {
                total++;
            }
            if (data[x + 1][y][0]) {
                total++;
            }
            if (data[x + 1][y + 1][0]) {
                total++;
            }

            return total;
        },

        /**
         * @function
         * @instance
         * @description
         return the data value at coordinates x,y.  this is the main "model" function that allows for virtualization
         * #### returns: Object
         * @param {number} x - the x coordinate
         * @param {number} y - the y coordinate
         */
        getValue: function(x, y) {
            return this.data[x][y];
        },

        /**
         * @function
         * @instance
         * @description
         set the data value at coordinates x,y
         * @param {number} x - the x coordinate
         * @param {number} y - the y coordinate
         */
        setValue: function(x, y, value) {
            this.data[x][y] = value;
        },

        /**
         * @function
         * @instance
         * @description
         return the value at x,y for the fixed row area
         * #### returns: Object
         * @param {number} x - x coordinate
         * @param {number} y - y coordinate
         */
        getFixedColumnValue: function(x, y) {
            return y;
        },

        /**
        * @function
        * @instance
        * @description
        return the data value at point x,y
        * #### returns: Object
        * @param {number} x - x coordinate
        * @param {number} y - y coordinate
        */
        getFixedRowValue: function(x, y) {
            noop(x, y);
            return '';
        },

        /**
         * @function
         * @instance
         * @description
         return the number of fixed columns
         * #### returns: integer
         */
        getFixedColumnCount: function() {
            return 0;
        },

        /**
         * @function
         * @instance
         * @description
         return the count of fixed rows
         * #### returns: integer
         */
        getFixedRowCount: function() {
            return 0;
        },

        /**
         * @function
         * @instance
         * @description
         return the total number of columns
         * #### returns: integer
         */
        getColumnCount: function() {
            return this.data.length;
        },

        /**
         * @function
         * @instance
         * @description
         return the number of rows
         * #### returns: integer
         */
        getRowCount: function() {
            return this.data[0].length;
        },

        /**
         * @function
         * @instance
         * @description
         get height in pixels of a specific row
         * #### returns: integer
         * @param {number} rowNum - row index of interest
         */
        getRowHeight: function(y) {
            noop(y);
            return 10;
        },

        /**
         * @function
         * @instance
         * @description
         return the column width at index x
         * #### returns: integer
         * @param {number} x - the column index of interest
         */
        getColumnWidth: function(x) {
            noop(x);
            return 10;
        },

        /**
        * @function
        * @instance
        * @description
        provide the label for the toggle state
        * #### returns: string
        */
        getNextState: function() {
            if (this.running) {
                return 'pause';
            } else {
                return 'play';
            }
        },
        /**
         * @function
         * @instance
         * @description
         toggle the value at position specified by the mouse point
         * @param {Hypergrid} grid
         * @param {Object} event - the event details
         */
        onTap: function(grid, mouse) {

            var mX = this.getScrollPositionX() + mouse.gridCell.x;
            var mY = this.getScrollPositionY() + mouse.gridCell.y;

            var v = this._getValue(mX, mY)[0];
            this._setValue(mX, mY, [!v, 1]);
            this.changed();
        },

        /**
        * @function
        * @instance
        * @description
        apply the gol well known template at x,y
        * @param {Array} array - an array2D gamegrid to modifiy
        * @param {number} c - column coordinate
        * @param {number} r - row coordinate
        * @param {Array} pattern - a 2d matrix of a well known gol template
        * @param {number} dir - direction to rotate the pattern
        */
        applyPatternAt: function(array, c, r, pattern, dir) {
            var w = pattern.length;
            var h = pattern[0].length;
            var x = 0;
            var y = 0;
            if (dir === 0) {
                for (x = 0; x &lt; w; x++) {
                    for (y = 0; y &lt; h; y++) {
                        array[x + c][y + r] = [pattern[w - x - 1][y], 1];
                    }
                }
            } else if (dir === 1) {
                for (x = 0; x &lt; w; x++) {
                    for (y = 0; y &lt; h; y++) {
                        array[x + c][y + r] = [pattern[x][y], 1];
                    }
                }
            } else if (dir === 2) {
                for (x = 0; x &lt; w; x++) {
                    for (y = 0; y &lt; h; y++) {
                        array[y + c][x + r] = [pattern[x][y], 1];
                    }
                }
            } else {
                for (x = 0; x &lt; w; x++) {
                    for (y = 0; y &lt; h; y++) {
                        array[y + c][x + r] = [pattern[w - x - 1][y], 1];
                    }
                }
            }
        }

    });

})(); /* jslint ignore:line */
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-behaviors_default.html">behaviors\default</a></li><li><a href="module-behaviors_gol.html">behaviors\gol</a></li><li><a href="module-behaviors_in-memory.html">behaviors\in-memory</a></li><li><a href="module-behaviors_q.html">behaviors\q</a></li><li><a href="module-behaviors_qtree.html">behaviors\qtree</a></li><li><a href="module-behaviors_web-worker.html">behaviors\web-worker</a></li><li><a href="module-defaults.html">defaults</a></li></ul><h3>Classes</h3><ul><li><a href="Behavior.html">Behavior</a></li><li><a href="behaviors.JSON.html">JSON</a></li><li><a href="behaviors.Local.html">Local</a></li><li><a href="CellClick.html">CellClick</a></li><li><a href="CellEditing.html">CellEditing</a></li><li><a href="CellEditor.html">CellEditor</a></li><li><a href="CellProvider.html">CellProvider</a></li><li><a href="CellSelection.html">CellSelection</a></li><li><a href="Choice.html">Choice</a></li><li><a href="Color.html">Color</a></li><li><a href="Column.html">Column</a></li><li><a href="ColumnAutosizing.html">ColumnAutosizing</a></li><li><a href="ColumnMoving.html">ColumnMoving</a></li><li><a href="ColumnPicker.html">ColumnPicker</a></li><li><a href="ColumnResizing.html">ColumnResizing</a></li><li><a href="ColumnSchemaFactory.html">ColumnSchemaFactory</a></li><li><a href="ColumnSelection.html">ColumnSelection</a></li><li><a href="ColumnSorting.html">ColumnSorting</a></li><li><a href="Combo.html">Combo</a></li><li><a href="ComboBox.html">ComboBox</a></li><li><a href="ConditionalsCql.html">ConditionalsCql</a></li><li><a href="DataModel.html">DataModel</a></li><li><a href="dataModels.JSON.html">JSON</a></li><li><a href="Date.html">Date</a></li><li><a href="DecoratorBase.html">DecoratorBase</a></li><li><a href="Default.html">Default</a></li><li><a href="DefaultFilter.html">DefaultFilter</a></li><li><a href="Dialog.html">Dialog</a></li><li><a href="Feature.html">Feature</a></li><li><a href="Filters.html">Filters</a></li><li><a href="Hypergrid.html">Hypergrid</a></li><li><a href="InMemory.html">InMemory</a></li><li><a href="KeyPaging.html">KeyPaging</a></li><li><a href="ManageFilters.html">ManageFilters</a></li><li><a href="Null.html">Null</a></li><li><a href="OnHover.html">OnHover</a></li><li><a href="ParserCQL.html">ParserCQL</a></li><li><a href="Renderer.html">Renderer</a></li><li><a href="RowResizing.html">RowResizing</a></li><li><a href="RowSelection.html">RowSelection</a></li><li><a href="SelectionModel.html">SelectionModel</a></li><li><a href="Simple.html">Simple</a></li><li><a href="Slider.html">Slider</a></li><li><a href="Spinner.html">Spinner</a></li><li><a href="Textfield.html">Textfield</a></li><li><a href="ThumbwheelScrolling.html">ThumbwheelScrolling</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-filter-api.html">filter-api</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addDeepProperties">addDeepProperties</a></li><li><a href="global.html#allColumns">allColumns</a></li><li><a href="global.html#append">append</a></li><li><a href="global.html#close">close</a></li><li><a href="global.html#columns">columns</a></li><li><a href="global.html#copy">copy</a></li><li><a href="global.html#copyAll">copyAll</a></li><li><a href="global.html#getBehavior">getBehavior</a></li><li><a href="global.html#getColumnFilter">getColumnFilter</a></li><li><a href="global.html#getFilter">getFilter</a></li><li><a href="global.html#getGrid">getGrid</a></li><li><a href="global.html#getTableFilter">getTableFilter</a></li><li><a href="global.html#hideEditor">hideEditor</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#onClick">onClick</a></li><li><a href="global.html#onTransitionEnd">onTransitionEnd</a></li><li><a href="global.html#open">open</a></li><li><a href="global.html#renderCellError">renderCellError</a></li><li><a href="global.html#saveFolder">saveFolder</a></li><li><a href="global.html#saveFolders">saveFolders</a></li><li><a href="global.html#setColumnFilterState">setColumnFilterState</a></li><li><a href="global.html#setFilter">setFilter</a></li><li><a href="global.html#setTableFilter">setTableFilter</a></li><li><a href="global.html#showEditor">showEditor</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Mon Apr 11 2016 14:58:32 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
