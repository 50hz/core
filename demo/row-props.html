<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <style>
        .hypergrid-container { width:1580px; height:1050px; }
        body { margin: 5px }
        body > label, .radio-group {
            display: inline-block;
            background-color: beige;
            margin: 0 .5em 7px 5px;
            padding: .15em .5em .15em .35em;
            border: 1px solid tan;
            font-family: sans-serif;
            font-size: 10pt;
            user-select: none;
        }
        input[type=checkbox] { outline:0 }
        div#behind {
            position: absolute;
            visibility: hidden;
            top: 150px;
            left: 150px;
            width: 400px;
            height: 400px;
            border-radius: 500px;
            border: 8px solid black;
            background-color: orange;
        }
</style>
</head>
<body>
    <label title="grid.properties.enableContinuousRepaint = true vs. false">
        <input type="checkbox" onclick="grid.properties.enableContinuousRepaint=this.checked">
        Continuous repaint
    </label>
    <div class="radio-group">
        Render by:
        <label title="setGridRenderer('by-cells');
——————————————————
This is the partial renderer. Relatively non-performant compared to some of the other grid renderers due to having to draw all cell background rects. That said, when the cell backgrounds are all opaque, this can serve as an alternative to clipping.">
            <input type="radio" name="renderer" onclick="grid.renderer.setGridRenderer('by-cells')">
            cells (partial)
        </label>

        <label title="setGridRenderer('by-columns-discrete');
——————————————————
Renders each column with its own background rect, and then its cells. If the colors of the column backgrounds are all opaque, this can serve as an alternative to clipping.">
            <input type="radio" name="renderer" onclick="grid.renderer.setGridRenderer('by-columns-discrete')">
            columns (discrete)
        </label>

        <label title="setGridRenderer('by-columns');
——————————————————
Renders all cells over consolidated column backgrounds, if any. (These column backgrounds are however unsuitable as a clipping alternative because they are all drawn before any of the cells are drawn.)">
            <input type="radio" name="renderer" onclick="grid.renderer.setGridRenderer('by-columns')">
            columns (consolidated)
        </label>

        <label title="setGridRenderer('by-columns-and-rows');
——————————————————
Renders all cells over consolidated row backgrounds, if any; otherwise over consolidated column backgrounds, if any. (Such column backgrounds are however unsuitable as a clipping alternative because they are all drawn before any of the cells are drawn.)">
            <input type="radio" name="renderer" onclick="grid.renderer.setGridRenderer('by-columns-and-rows')" checked>
            columns (consolidated rows)
        </label>

        <label title="setGridRenderer('by-rows');
——————————————————
Renders all cells over consolidated row backgrounds, if any. Unsuitable as a clipping alternative. Caveat: This renderer turned out to be the least performant of all (for unclear reasons -- possibly due to poor optimization).">
            <input type="radio" name="renderer" onclick="grid.renderer.setGridRenderer('by-rows')">
            rows (consolidated)
        </label>
    </div>
    <div class="radio-group">
        Clip to:
        <label title="grid.properties.columnClip = true">
            <input type="radio" name="clipping" onclick="grid.properties.columnClip = true; // can be overridden at column level">
            all columns
        </label>
        <label title="grid.properties.columnClip = null">
            <input type="radio" name="clipping" onclick="grid.properties.columnClip = null; // can be overridden at column level">
            last column only
        </label>
        <label title="grid.properties.columnClip = false">
            <input type="radio" name="clipping" onclick="grid.properties.columnClip = false; // can be overridden at column level" checked>
            none
        </label>
    </div>
    <div class="radio-group">
        Text truncation:
        <label title="grid.properties.truncateTextWithEllipsis = undefined; // can be overridden at a higher level">
            <input type="radio" name="truncate" onclick="grid.properties.truncateTextWithEllipsis = undefined">
            none
        </label>
        <label title="grid.properties.truncateTextWithEllipsis = true; // can be overridden at a higher level">
            <input type="radio" name="truncate" onclick="grid.properties.truncateTextWithEllipsis = true" checked>
            with ellipsis (&hellip;)
        </label>
        <label title="grid.properties.truncateTextWithEllipsis = false; // can be overridden at a higher level">
            <input type="radio" name="truncate" onclick="grid.properties.truncateTextWithEllipsis = false">
            <em>before</em> partial char
        </label>
        <label title="grid.properties.truncateTextWithEllipsis = null; // can be overridden at a higher level">
            <input type="radio" name="truncate" onclick="grid.properties.truncateTextWithEllipsis = null">
            <em>after</em> partial char
        </label>
    </div>
    <label title="Adds a rowProperties array to grid.properties that defines 3 grid background rows alternating with 3 light green rows.">
        <input type="checkbox" onclick="if(this.checked)grid.addProperties(alternatingThreeGreenRows);else deleteProps(grid.properties,alternatingThreeGreenRows);grid.renderer.resetAllGridRenderers()">
        Grid row properties
    </label>
    <label title="Column properties defines a light blue background color BUT inherit's grid's rowProperties array.">
        <input type="checkbox" onclick="columnProps(this.checked, [2,3], columnColorUnderAlternateColors)">
        Columns 2-3 <em>under</em> alternating rows
    </label>
    <label title="Column properties defines a light blue background color AND overrides rowProperties with an undefined.">
        <input type="checkbox" onclick="columnProps(this.checked, [6,7], columnColorOverAlternateColors)">
        Columns 6-7 <em>over</em> alternating rows
    </label>
    <label title="Column properties overrides grid's rowProperties with one of its own that defines 2 tan rows alternating with 2 beige rows.">
        <input type="checkbox" onclick="columnProps(this.checked, [10,11], columnOwnAlternateColors)">
        Columns 10-11 override row props
    </label>
    <div class="radio-group">
        Striped columns:
        <label title="altColumnProps.call(this, { backgroundColor: rgb(210, 180, 140) })">
            <input type="radio" name="striped-columns" onclick="altColumnProps(true, { backgroundColor: 'rgb(210, 180, 140)' })">
            tan
        </label>
        <label title="altColumnProps.call(this, { backgroundColor: rgba(210, 180, 140, .5) })">
            <input type="radio" name="striped-columns" onclick="altColumnProps(true, { backgroundColor: 'rgba(210, 180, 140, .5)' })">
            translucent tan
        </label>
        <label title="document.body.style.backgroundColor='beige'">
            <input type="radio" name="striped-columns" onclick="altColumnProps(false, columnColorUnderAlternateColors)" checked>
            none
        </label>
    </div>
    <div class="radio-group">
        body color:
        <label title="document.body.style.backgroundColor='white'">
            <input type="radio" name="bodybg" onclick="document.body.style.backgroundColor='white'" checked>
            white
        </label>
        <label title="document.body.style.backgroundColor='beige'">
            <input type="radio" name="bodybg" onclick="document.body.style.backgroundColor='lime'">
            lime
        </label>
    </div>
    <div class="radio-group">
        grid color:
        <label title="grid.properties.backgroundColor='white'">
            <input type="radio" name="gridbg" onclick="grid.properties.backgroundColor='white'" checked>
            white
        </label>
        <label title="grid.properties.backgroundColor='transparent'">
            <input type="radio" name="gridbg" onclick="grid.properties.backgroundColor='transparent'">
            transparent
        </label>
        <label title="grid.properties.backgroundColor='rgb(128,128,255)'">
            <input type="radio" name="gridbg" onclick="grid.properties.backgroundColor='rgb(128,128,255)'">
            blue
        </label>
        <label title="grid.properties.backgroundColor='rgba(128,128,255,.5)">
            <input type="radio" name="gridbg" onclick="grid.properties.backgroundColor='rgba(128,128,255,.5)';">
            translucent blue
        </label>
    </div>
    <label>
        <input type="checkbox" onclick="document.querySelector('#behind').style.visibility=this.checked?'visible':'hidden'">
        Behind-the-grid content
    </label>

    <div id="behind"></div>

    <script src="build/fin-hypergrid.js"></script>

    <script>
var data = [
    { s: 'APPL', n: 'Apple', c: 93.13 },
    { s: 'MSFT', n: 'Microsoft', c: 51.91 },
    { s: 'TSLA', n: 'Tesla', c: 196.48 },
    { s: 'IBM', n: 'IBM', c: 155.35 }
];
var grid = new fin.Hypergrid();
data.forEach(function(dr) { for (var i=1; i<=9; ++i) { ['s','n','c'].find(function(key) { dr[key+i] = mangle(dr[key]) }); } });
for(var i=0; i<256-4; ++i) {
    var row = {};
    for (var fld in data[0]) {
        row[fld] = mangle(data[0][fld]);
    }
    data.push(row);
}
grid.setData(data);
grid.addProperties({
    backgroundColor: 'white',
    foregroundSelectionFont: '13px Tahoma, Geneva, sans-serif',
    columnClip: false,
    editor: 'textfield',
//    showHeaderRow: false,
//    showFilterRow: true, // requires getColumnFilterState and setColumnFilterState (add-ons/hyper-filter plug-in)
    showRowNumbers: false,
    lineColor: 'brown',
//    gridLinesH: false,
//    gridLinesV: false,
//    enableContinuousRepaint: true
});

var alternatingThreeGreenRows = {
        rowProperties: [
            undefined,
            undefined,
            undefined,
            { color: '#116611', backgroundColor: '#e8ffe8' },
            { color: '#116611', backgroundColor: '#e8ffe8' },
            { color: '#116611', backgroundColor: '#e8ffe8' }
        ]
    },
    columnColorUnderAlternateColors = {
        backgroundColor: 'lightblue'
    },
    columnColorOverAlternateColors = {
        backgroundColor: 'lightblue',
        rowProperties: undefined
    },
    columnOwnAlternateColors = {
        rowProperties: [
            { backgroundColor: 'beige' },
            { backgroundColor: 'beige' },
            { backgroundColor: 'tan' },
            { backgroundColor: 'tan' }
        ]
    };

function altColumnProps(checked, props) {
    grid.renderer.visibleColumns.forEach(function(column, i) {
        if (i & 1) {
            columnProps(checked, [i, i], props);
        }
    }, this);
}

function columnProps(checked, columnIndexes, props) {
    columnIndexes.forEach(function(columnIndex) {
        if (checked) {
            grid.setColumnProperties(columnIndex, props);
        } else {
            deleteProps(grid.getColumnProperties(columnIndex), columnColorOverAlternateColors);
        }
    });
    if (!checked) {
        grid.behavior.changed();
    }
}

function deleteProps(object, props) {
    for (var key in props) {
        if (props.hasOwnProperty(key)) {
            delete object[key];
        }
    }
}

function mangle(s) {
    return s.toString().split('').map(function(c) {
        if (/\d/.test(c)) {
            return Math.random() * 9 + 1 | 0;
        } else if (/[A-Z]/.test(c)) {
            return String.fromCharCode(Math.random() * 26 + 65 | 0);
        } else if (/[a-z]/.test(c)) {
            return String.fromCharCode(Math.random() * 26 + 97 | 0);
        } else {
            return c;
        }
    }).join('');
}
    </script>
</body>
</html>
